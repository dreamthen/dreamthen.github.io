---
title: 比木白-React
date: 2020-02-27 20:59:40
tags: [react]
categories: React
comments: true
---

# React

  ## List List.Item 
  
  > 原因

  最近在搞CBA m站适配时,尝试写了一把JS 基础组件,首当其冲的就是List List.Item列表组件,在我们m站适配中随处可见,其关键点就在于,怎么将某些在List列表组件中的属性,放到Item列表项组件里面,至此就想到了使用HOC高阶组件。

  > 详情

  ```jsx harmony
    //List组件
    import React, {PureComponent} from 'react';
    import PropTypes from 'prop-types';
    import cns from 'classnames';
    import Item from './item';
    
    class List extends PureComponent {
        static propTypes = {
            className: PropTypes.string,
            onClick: PropTypes.func
        };

        static Item = Item;

        constructor(props) {
            super(props);
        }
        
        //Item高阶组件
        itemHOC = () => {
            const {children, onClick = () => {}} = this.props;
            return (children && children.length > 0) ? React.Children.map(children, (child = {}) => {
                const {type: Child, props = {}} = child;
                if(Child !== Item) {
                    throw new TypeError('List component must be an Item component inside~');
                }
                return <Child {...props} onClick={onClick}/>;
            }) : null;
        }
        
        render() {
            const {className = ''} = this.props;
            const {itemHOC = () => {}} = this;
            return (
                <section className={cns(
                    'list',
                    className
                )}>
                    {itemHOC()}
                </section>
            )
        }
    }

    export default List;
  ```

  ```jsx harmony
    //Item组件  
    import React, {PureComponent} from 'react';
    import PropTypes from 'prop-types';
    import cns from 'classnames';
    import './index.less';

    class Item extends PureComponent {
        static propTypes = {
            className: PropTypes.string,
            onClick: PropTypes.func,
            value: PropTypes.any
        };

        constructor(props) {
            super(props);
        }
        
        render() {
            const {
                className = '', 
                value,
                onClick = () => {}, 
                children
            } = this.props;
            return (
                <div className={cns('list-item', className)}
                     onClick={(e) => onClick(value, e)}
                >
                    {children}
                </div>
            )   
        }
    }

    export default Item;
  ```

  ```css
    /*Item组件样式*/
    .list-item {
      padding: 14px 20px;
      background-color: #fff;
      border-bottom: 1px solid #ddd;
    }
  ```

  这样就完成了List列表组件 List.Item列表项的基础组件的基础搭建,使用起来也是很简单的...
  
  > 使用

  ```jsx harmony
    import React, {PureComponent} from 'react';
    import List from './components';
    
    const Item = List.Item;
    
    class Demo extends PureComponent {
        constructor(props) {
            super(props);
        }
                
        render() {
            const list = Array.from(Array.apply(null, {length: 10}), (item, index) => {
                return {[index]: (index + 1)};        
            });
            return (
                //...
                <List className='demo-list'
                      onClick={(item, e) => {
                        console.log(item);
                      }}
                >
                    {
                        list && list.length > 0 && list.map((listItem, index) => {
                            return <Item className='demo-list-item'
                                         value={listItem}
                                         key={index}
                            >
                                {JSON.stringify(listItem)}
                            </Item>
                        })
                    }
                </List>
            )
        }
    }
  ```