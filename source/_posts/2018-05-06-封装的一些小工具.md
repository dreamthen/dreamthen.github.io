---
title: 2018-05-06 封装的一些小工具
date: 2018-05-06 17:01:43
tags: [封装, 小工具]
categories: 封装的一些小工具
---
# debounce函数节流

> 函数节流通常被用于输入下拉框、滚动懒加载等场景,目的只有一个,在短时间内,限制多次调用后台接口,浪费大量资源,防止接口响应数据时间上的误差造成的页面显示数据的错误。
    
    //设置一个timer变量,用来承接setTimeout返回的延时对象
    const timer = null;
    //函数节流方法
    function debounce(fuc, delay) {
        //每一次进行输入或者拉动滚动条的时候,都会对延时对象进行判断,假如存在延时对象,就停止延时对象,并把延时对象置为空,释放内存,使得垃圾回收机制能更快的对延时对象进行回收
        if(timer) {
            clearTimeout(timer);
            timer = null;
        }
        //给延时对象赋予一个延时方法,fuc就是请求后台接口的函数,delay就是延时时间
        timer = setTimeout(fuc, delay);
    }
    //函数节流方法,只要在delay时间内,再次触发此方法,延时对象就会被停止且置空,后台的接口函数就不会被调用。
    //做到了在短时间内输入或者滚动限制了多次调用后台接口,防止了接口响应数据时间上的误差造成页面数据显示的错误。
    
# getElementsByClassName封装

> getElementsByClassName是HTML5 DOM引入的一个获取class样式节点的方法,有一些不支持HTML5 DOM的浏览器可能不存在这个方法,所以需要对这个方法进行封装

    //html code
    <!Doctype html>
    <html lang="zh-cn">
        <head>
            <meta charset="utf-8">
            <title>getElemetnsByClassName封装</title>
        </head>
        <body>
            <div id="home">
                <p class="number">first</p>
                <p class="number second">second</p>
                <p class="number">third</p>
            </div>
        </body>
        <script type="text/javascript" src="boxesByClassName.js"></script>
    </html>
    
    //boxesByClassName.js
    function getElementsByClassName(node, className) {
        //判断DOM是否有getElementsByClassName方法,假如有,就返回node节点下的所有className子节点
        if(node.getElementsByClassName) {
            return node.getElementsByClassName(className);
        } else {
        //假如没有,就先去获取node节点下的所有子节点元素,然后根据子节点元素的className属性进行匹配外部传入的className,假如包含此className,就传入返回的数组中,最后返回数组
            let _get_className_arr = [],
                _tag_arr = node.getElementsByTagName("*"),
                _tag_arr_length = _tag_arr.length;
            for(let i = 0; i < _tag_arr_length; i++) {
                if(_tag_arr[i].className.includes(className)){
                    _get_className_arr[_get_className_arr.length] = _tag_arr[i];
                }
            }
            return _get_className_arr;
        }
    }
    
    